<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title>我</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.css" rel="stylesheet" />
		<link href="./icon/iconfont.css" rel="stylesheet"/>
		<script src="./icon/iconfont.js"></script>
	</head>

	<body>
		
		<div class="mui-content">
			
			<style>
			
				.title {
					background-color: white;
				}
				
				#arrow {
					margin-top: 56px;
				}
				
				.table-view {
					height: 140px;
				}
				
				.media-body {
					margin-left: 20px;
					margin-top: 32px;
				}
				
				.table-view {
					background-color: #FFFFFF;
				}
				
				.icon {
				  width: 1em;
				  height: 1em;
				  vertical-align: -0.15em;
				  fill: currentColor;
				  overflow: hidden;
				}
				
			</style>
					
			<ul class="mui-table-view table-view">
				<li class="mui-table-view-cell mui-media" style="padding-top: 10px;">
					<a id="link_info" href="javascript:;">
						
						<span id="arrow" class="mui-pull-right mui-icon mui-icon-arrowright"
								style="color: lightgray;margin-left: 3px;"></span>
						<img id="arrow" class="mui-media-object mui-pull-right"
							src="image/qrcode.png" style="max-width: 20px;height: 20px;">
						<div class="mui-media-body media-body" style="line-height: 32px; margin-left: 20px;">
							<img id="img_my_face" class="mui-media-object mui-pull-left" src=""
								style="border-radius: 8%;line-height: 50px;max-width: 60px;height: 60px;">
							<div class="mui-media-body" style="margin-left: 20px;">
								</div>&nbsp;&nbsp; <label id="span_nickname" style="font-size: 20px;"></label>
								<br/>
								<p style="display:inline;">&nbsp;&nbsp;&nbsp;微信号：</p><p id="span_username" class="mui-ellipsis" style="display:inline;"></p>
							</div>
						</div>
					</a>
				</li>
			</ul>

		</div>
				
		<div style="line-height:8px;">
			&nbsp;
		</div>
			
		<ul class="mui-table-view">
			
			<li class="mui-table-view-cell mui-media">
				<a id="link_fuwu" href="javascript:;">
					<span class="mui-pull-right mui-icon mui-icon-arrowright" 
							style="color: lightgray;margin-left: 3px; line-height: 32px;"></span>
					<span id="span_nickname" class="mui-pull-right" 
							style="color: gray;font-size: 14px;"></span>
					<div class="mui-media-body" style="line-height: 32px;">
						<p class="mui-icon iconfont icon-weixinzhifu1" style="color: #2AC845; font-size: 20px;"></p>&nbsp;&nbsp;&nbsp;服务
					</div>
				</a>
			</li>
		</ul>
			
			<div style="line-height:8px;">
				&nbsp;
			</div>
			
		<ul class="mui-table-view">
			<li class="mui-table-view-cell mui-media" >
				<a id="link_shoucang" href="javascript:;">
					<span class="mui-pull-right mui-icon mui-icon-arrowright" 
							style="color: lightgray;margin-left: 3px; line-height: 32px;"></span>
					<span id="span_nickname" class="mui-pull-right" 
							style="color: gray;font-size: 14px;"></span>
					<div class="mui-media-body" style="line-height: 32px;">
						<svg class="icon" aria-hidden="true" style="font-size: 20px;">
						  <use xlink:href="#icon-shoucang1"></use>
						</svg> &nbsp;&nbsp;&nbsp;收藏
					</div>
				</a>
			</li>
			<li class="mui-table-view-cell mui-media">
				<a id="link_pengyouquan" href="javascript:;">
					<span class="mui-pull-right mui-icon mui-icon-arrowright" 
							style="color: lightgray;margin-left: 3px; line-height: 32px;"></span>
					<span id="span_nickname" class="mui-pull-right" 
							style="color: gray;font-size: 14px;"></span>
					<div class="mui-media-body" style="line-height: 32px;">
						<svg class="icon" aria-hidden="true" style="font-size: 20px;">
						  <use xlink:href="#icon-pengyouquan"></use>
						</svg> &nbsp;&nbsp;&nbsp;朋友圈
					</div>
				</a>
			</li>
			<li class="mui-table-view-cell mui-media">
				<a id="link_kabao" href="javascript:;">
					<span class="mui-pull-right mui-icon mui-icon-arrowright" 
							style="color: lightgray;margin-left: 3px; line-height: 32px;"></span>
					<span id="span_nickname" class="mui-pull-right" 
							style="color: gray;font-size: 14px;"></span>
					<div class="mui-media-body" style="line-height: 32px;">
						<svg class="icon" aria-hidden="true" style="font-size: 20px;">
						  <use xlink:href="#icon-shipin"></use>
						</svg> &nbsp;&nbsp;&nbsp;视频号
					</div>
				</a>
			</li>
			<li class="mui-table-view-cell mui-media">
				<a id="link_kabao" href="javascript:;">
					<span class="mui-pull-right mui-icon mui-icon-arrowright" 
							style="color: lightgray;margin-left: 3px; line-height: 32px;"></span>
					<span id="span_nickname" class="mui-pull-right" 
							style="color: gray;font-size: 14px;"></span>
					<div class="mui-media-body" style="line-height: 32px;">
						<svg class="icon" aria-hidden="true" style="font-size: 20px;">
						  <use xlink:href="#icon-kabao"></use>
						</svg> &nbsp;&nbsp;&nbsp;卡包
					</div>
				</a>
			</li>
			<li class="mui-table-view-cell mui-media">
				<a id="link_biaoqing" href="javascript:;">
					<span class="mui-pull-right mui-icon mui-icon-arrowright" 
							style="color: lightgray;margin-left: 3px; line-height: 32px;"></span>
					<span id="span_nickname" class="mui-pull-right" 
							style="color: gray;font-size: 14px;"></span>
					<div class="mui-media-body" style="line-height: 32px;">
						<svg class="icon" aria-hidden="true" style="font-size: 20px;">
						  <use xlink:href="#icon-happy-"></use>
						</svg> &nbsp;&nbsp;&nbsp;表情
					</div>
				</a>
			</li>
		</ul>
		
		<br />
		
		<ul class="mui-table-view">
			<li class="mui-table-view-cell mui-media" 
				style="text-align: center;">
				<a id="link_logout" href="javascript:;">
					<div class="mui-media-body" style="line-height: 32px;">
						退出登录
					</div>
				</a>
			</li>
		</ul>
		
		<script src="js/mui.js"></script>
		<script src="js/app.js"></script>
		<script type="text/javascript">
			mui.init()
			
			mui.plusReady(function () {
				
				
				refreshUserInfo();    
				
				// 自定义页面刷新事件
				window.addEventListener("refresh", function(){
					refreshUserInfo();
				});
				
				// 获取当前页面webview，刷新用户信息
				var mewebview = plus.webview.currentWebview();
				mewebview.addEventListener("show", function(){
					refreshUserInfo();
				});
				
				
				// 页面跳转至我的个人信息
				var link_info = document.getElementById("link_info");
				link_info.addEventListener("tap", function(){
					mui.openWindow("my-info.html", "my-info.html");
				});
		
				
				// 用户退出
				var link_logout = document.getElementById("link_logout");
				link_logout.addEventListener("tap", function(){
					// console.log("退出....");
					app.userLogout();
					mui.openWindow("login.html", "login.html");
				});
				
				
				// 刷新页面用户信息
				function refreshUserInfo(){
					// 从手机缓存中获取用户信息
					var user = app.getUserGlobalInfo();
					console.log(JSON.stringify(user));	// user为json对象
					
					if(user != null){
						var faceImage = user.faceImage;
						var nickname = user.nickname;
						var username =  user.username;
						
						var span_nickname = document.getElementById("span_nickname");
						var span_username = document.getElementById("span_username");
						
						span_nickname.innerHTML = nickname;
						span_username.innerHTML = username;
						
						if(app.isNotNull(faceImage)){
							var img_my_face = document.getElementById("img_my_face");
							// 设置头像，地址为图片服务器里的图像
							img_my_face.src = app.imageServerUrl + faceImage;
							console.log(img_my_face.src);
						}
					}
				}
				

			});
			
			
			
		</script>
	</body>

</html>
 